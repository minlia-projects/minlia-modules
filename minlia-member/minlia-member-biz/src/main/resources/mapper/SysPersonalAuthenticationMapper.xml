<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.minlia.module.member.mapper.SysPersonalAuthenticationMapper">

    <select id="selectMemberByUid" resultType="com.minlia.module.member.bean.vo.SysMemberInfoVo">
        SELECT
            sut.id AS 'uid',
            sut.avatar,
            sut.nickname,
            sut.email,
            sut.cellphone,
            sut.invite_code,
            sut.`status`,
            sut.last_login_ip,
            sut.last_login_time,
            sut.create_date AS 'registerTime',
            swt.balance	AS 'walletBalance',
            (SELECT `status` FROM sys_personal_authentication WHERE uid = #{uid}) AS 'personalAuthStatus'
        FROM
            sys_user sut
        LEFT JOIN sys_wallet swt ON swt.uid = sut.id
        WHERE
            sut.id = #{uid}
        AND sut.default_role IN ('ROLE_MEMBER','ROLE_STORE','ROLE_SUB_STORE')
    </select>

    <select id="selectMemberPage" resultType="com.minlia.module.member.bean.vo.SysMemberInfoVo">
        SELECT
            sut.id AS 'uid',
            sut.avatar,
            sut.nickname,
            sut.email,
            sut.cellphone,
            sut.invite_code,
            sut.`status`,
            sut.create_date,
            sut.last_login_ip,
            sut.last_login_time,
            swt.balance	AS 'walletBalance'
        FROM
            sys_user sut
        LEFT JOIN sys_wallet swt ON sut.id = swt.uid
        WHERE
            sut.default_role IN ('ROLE_MEMBER')
    </select>

</mapper>
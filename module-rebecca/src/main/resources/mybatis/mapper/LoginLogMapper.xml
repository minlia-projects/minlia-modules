<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.minlia.modules.rbac.mapper.LoginLogMapper">

    <sql id="QUERY_CONTENT">
		SELECT
			id ,
			username ,
			password ,
			ip_address ,
			time
		FROM
			mdl_login_log
	</sql>

    <sql id="QUERY_CONDITION">
        <where>
            <if test="username != null">
                AND username = #{username,jdbcType=VARCHAR}
            </if>
            <if test="ipAddress != null">
                AND ip_address = #{ipAddress,jdbcType=TINYINT}
            </if>
        </where>
    </sql>

    <sql id="ORDER_BY">
        <if test="sorts != null">
            ORDER BY
            <foreach collection="sorts" item="item" separator=",">
                ${item.filed} ${item.direction}
            </foreach>
        </if>
    </sql>

    <insert id="create" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO mdl_login_log(
		    username ,
		    password ,
		    ip_address ,
		    time
        )VALUES(
            #{username,jdbcType=VARCHAR} ,
            #{password,jdbcType=VARCHAR} ,
            #{ipAddress,jdbcType=VARCHAR} ,
            #{time,jdbcType=VARCHAR}
        )
	</insert>

    <select id="queryList" resultType="com.minlia.modules.rbac.bean.domain.LoginLog">
        <include refid="QUERY_CONTENT"/>
        <include refid="QUERY_CONDITION"/>
        <include refid="ORDER_BY"/>
    </select>

</mapper>